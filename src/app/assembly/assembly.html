<div  style="position: fixed; width: 100%; height: 100%;">
<div class="container-fluid" >
<style>
    .list-group.active {
        display:none;
    }
    .draft {
        color: #666;
    }

    tbody.ng-invalid-ensure-value.ng-dirty {
      background-color:#f2dede;
    }
    .haute-ligne {
        height: 3.5em;
    }
</style>
<div class="row big-list">
    <div ng-hide="sync.data"><h1>Loading</h1></div>
    <div ng-show="sync.data.length == 0"><h2>No data</h2></div>
</div>
<div class="row big-list" ng-show="sync.data.length">
    <div class="col-md-5 col-no-padding">
        <div ui-view="orderList">ici ui-view</div>
    </div>
    <div class="col-md-7" style="position:relative" ng-class="{true: 'draft'}[sync.current.item.state=='done']">
        <ion-scroll class="prodoo-ion-scroll"  delegate-handle="rightScroll" direction="y">
            <div class="well">
                <h3>{{ sync.current.item.name}}</h3>
                <div ng-bind-html="sync.current.item.description"></div>
                <h2 ng-show="fields.length">Shelves</h2>
                <table class="table">
                    <tr ng-repeat="field in fields">
                        <th>{{ field.name }}</th>
                        <td>{{ field.rackÂ }}</td>
                    </tr>
                </table>
            </div>

            <div>
                <div class="btn-group btn-group-justified" style="display:none;">
                    <div class="btn-group">
                        <button class="btn btn-success haute-ligne" ng-click="take(sync.current.item)">
                            <span class="glyphicon glyphicon-download-alt" ng-disabled="!sync.current.item._v.lock"></span> 
                            Book 
                            <span class="badge badge-default">+ {{ sameLotNumber.length }}</span>
                        </button>
                    </div>
                </div>
            </div>

            <form name="grid" ng-submit="formSubmitted=1">
                <table class="table">
                    <tr>
                        <th ng-repeat="field in fields">{{ field.name }}</th>
                        <th colspan="2">Operations</th>
                        <th>Rack</th>
                    </tr>
                    <tbody ng-repeat="line in sync.current.item._v.lines track by $index" ng-form="f{{$index}}">
                        <tr ng-hide="isLineValid(grid, 'f'+$index) && line.lock" ng-class="{false: 'locked'}[line.lock]">
                            <td ng-repeat="s in line.scans track by $index">
                                <input class="haute-ligne" required="true" 
                                    ng-model="line.scans[$index]"
                                    ng-focus="focusOnLineScan(line, $index)" 
                                    ng-blur="lockOnValidLine(line, grid, 'f'+$parent.$index)"
                                    ensure-value="{{ sync.current.item.lot_number }}">
                                </input>
                            </td>
                            <td>
                                <div class="btn-group">
                                    <button type="button" class="btn btn-default haute-ligne" disabled><span class="glyphicon glyphicon glyphicon-flag"></span></button>
                                </div> 
                            </td>
                            <td>
                                <div class="btn-group">
                                    <button type="button" class="btn btn-warning haute-ligne" 
                                        ng-click="print(sync.current.item)" 
                                        ng-disabled="!sync.current.item.label"><span class="glyphicon glyphicon-print"></span>
                                    </button>
                                </div>
                            </td>
                      
                            <td>
                                <input class="haute-ligne col-xs-5" required="true"
                                    ng-model="line.rack"
                                    ng-focus="focusOnLineRack(line)"
                                    ng-blur="lockOnValidLine(line, grid, 'f'+$index)">
                                </input>
                                <button class="btn pull-right haute-ligne" 
                                    ng-click="line.lock=true" 
                                    ng-show="isLineValid(grid, 'f'+$index)">Confirm
                                </button>
                            </td>
                        </tr>
                        <tr ng-show="isLineValid(grid, 'f'+$index) && line.lock">
                            <td ng-repeat="s in line.scans track by $index">
                                {{ s }}
                            </td>
                            <td>
                                <div class="btn-group">
                                    <button type="button" class="btn btn-default haute-ligne" disabled><span class="glyphicon glyphicon glyphicon-flag"></span></button>
                                </div>
                            </td>
                            <td>
                                <div class="btn-group">
                                    <button type="button" class="btn btn-warning haute-ligne" 
                                        ng-click="print(sync.current.item)"
                                        ng-disabled="!sync.current.item.label"><span class="glyphicon glyphicon-print"></span>
                                    </button>
                                </div>
                            </td>
                            <td>{{line.rack}} <button class="btn pull-right haute-ligne" ng-click="line.lock=false">Edit</button></td>
                        </tr>
                    </tbody>
                </table>

                <div ng-show="sync.current.item.state == 'done'">
                    <div class="btn-group btn-group-justified">
                        <div class="btn-group">
                            <button class="btn btn-info haute-ligne" ng-click="do(sync.current.item)"><span class="glyphicon glyphicon-repeat" ng-disabled="!sync.current.item._v.lock"></span> Redo</button>
                        </div>
                    </div>
                </div>
                <div ng-hide="sync.current.item.state == 'done'">
                    <div class="btn-group btn-group-justified">
                        <div class="btn-group">
                            <button class="btn btn-success haute-ligne" 
                                ng-disabled="grid.$invalid || sync.current.item.pending || sync.current.item._v.lock || checkLocks()" 
                                ng-click="do(sync.current.item)"
                                data-toggle="modal" data-target="#casier-modal"> OK
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </ion-scroll>
    </div>
</div>
</div>
</div>